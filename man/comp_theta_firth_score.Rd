% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/firth_score.R
\name{comp_theta_firth_score}
\alias{comp_theta_firth_score}
\title{Firth-corrected estimating equation solution (score-based)}
\usage{
comp_theta_firth_score(data = NULL, weight = NULL, theta = NULL)
}
\arguments{
\item{data}{A data.frame (or list) with at least \code{y} (0/1) and \code{dose}.}

\item{weight}{Numeric vector of case weights, same length as \code{data$y}.}

\item{theta}{Numeric vector (length 3): \code{c(e0, emax, led50)} for initialization.}
}
\value{
A list with elements:
\describe{
  \item{par}{numeric(3) estimated parameters.}
  \item{Fisher.inf}{Observed/expected information matrix at the solution (from \code{Comp_I_score}).}
  \item{vc}{Fisher-based variance/covariance (from \code{Comp_Fish_inf}).}
  \item{score}{Score vector evaluated at the solution.}
}
}
\description{
Solves the Firth-corrected score equations for an Emax-type binary-response model.
Requires user-provided score and information helpers.
}
\details{
This function depends on internal helpers you must supply in the package:
\code{Score_e0()}, \code{Score_emax()}, \code{Score_led50()},
\code{Comp_Fish_inf()}, and \code{Comp_I_score()}.
}
\examples{
\dontrun{
if(interactive()){
 theta_true=matrix(c(qlogis(0.1),qlogis(0.8)-qlogis(0.1),log(7.5)),1,3)
 colnames(theta_true)<- c('e_0','emax','led_50')
 theta_true <- as.data.frame(theta_true)
 dose_set <- c(0,7.5,22.5,75,225)
 n=355
 data <-sim_data(theta_true,n,dose_set)
 res <- comp_theta_firth_score(data=data )
 }
}
}
\seealso{
\code{\link[clinDR]{fitEmax}}
}
