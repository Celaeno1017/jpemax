% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jeffery.R
\name{comp_theta_jeffrey}
\alias{comp_theta_jeffrey}
\title{Jeffreys-penalized likelihood estimator via Newtonâ€“Raphson}
\usage{
comp_theta_jeffrey(data = NULL, weight = NULL, theta = NULL)
}
\arguments{
\item{data}{A data.frame (or list) with \code{y} (0/1) and \code{dose}.}

\item{weight}{Numeric vector of case weights.}

\item{theta}{Numeric(3) initial guess \code{c(e0, emax, led50)}.}
}
\value{
A list with:
\describe{
  \item{par}{Estimated parameter vector.}
  \item{hessian}{Final Hessian returned by optimizer.}
  \item{vc}{Fisher-based variance/covariance.}
}
}
\description{
Maximizes the Jeffrey's prior-penalized log-likelihood for the binary Emax model
using \code{maxLik::maxNR}.
}
\details{
Requires helpers \code{Comp_Hess()}, \code{Comp_I()}, and \code{Comp_Hess_deriv()}
that compute the (penalized) Hessian, information, and derivatives of the Hessian.
}
\examples{
\dontrun{
if(interactive()){
 theta_true=matrix(c(qlogis(0.1),qlogis(0.8)-qlogis(0.1),log(7.5)),1,3)
 colnames(theta_true)<- c('e_0','emax','led_50')
 theta_true <- as.data.frame(theta_true)
 dose_set <- c(0,7.5,22.5,75,225)
 n=355
 data <-sim_data(theta_true,n,dose_set)
 res <- comp_theta_jeffrey(data=data )
 }
}
}
\seealso{
\code{\link[clinDR]{fitEmax}}
}
